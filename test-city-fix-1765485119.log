
> speed-date@0.1.0 test
> playwright test tests/load-test-50males-20females.spec.ts

[dotenv@17.2.3] injecting env (6) from .env.local -- tip: ğŸ”„ add secrets lifecycle management: https://dotenvx.com/ops

Running 1 test using 1 worker
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild
(node:65793) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
ğŸŒ Testing against Vercel: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app
ğŸ‘¤ Creating 1 male users via backend...
âœ… All 1 male users created
ğŸ‘¤ Creating 1 female users via backend...
âœ… All 1 female users created
ğŸŒ Opening browser contexts for all users...
âœ… Created 2 browser contexts
ğŸ” Signing in all users (batched to avoid server overload)...
  Signing in batch 1/1 (2 users)...
  âœ… Batch 1 complete: 2/2 users signed in
âœ… Sign-in complete: 2/2 users successfully signed in
ğŸ° 2 users clicking Start Spin (in batches)...
  Batch 1/1: 2 users clicking Start Spin...
    male Test Male 1: Clicking spin from https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spin
    female Test Female 1: Clicking spin from https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spin
    male Test Male 1: After click - URL: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spinning, API state: matched, matched: true, hasPartner: true
    female Test Female 1: After click - URL: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/voting-window?matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178, API state: matched, matched: true, hasPartner: true
  âœ… Batch 1 complete
âœ… 2 users clicked Start Spin
â³ Waiting for spin API calls to complete (3 seconds)...
ğŸ“ Checking user URLs after spin:
  - male Test Male 1: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/voting-window?matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  - female Test Female 1: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/voting-window?matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
â³ Waiting for matches to occur (45 seconds)...
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ” Checking match status via API...
    male Test Male 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
    female Test Female 1: state=matched, matched=true, matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
ğŸ“Š Checking match status for all signed-in users...

ğŸ—³ï¸ Testing voting flow: One user votes "yes", other doesn't vote (vote window expires)...
  Found match 98a4c70b-4a5c-4b5a-b94f-c779e612b178 with 2 users - testing yes_idle scenario (vote window expires)...
  â³ Waiting for both users to reach voting-window...
  â³ Waiting for voting window to be fully loaded...
  ğŸ“ User 0 current URL: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/voting-window?matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ“„ User 0 page content preview: speed dateTTest Female 1, 25Test user - Test Female 111RespinYes(self.__next_f=self.__next_f||[]).push([0])self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7968,[\"9673\",\"static/chunks/9673-e11b62...
  ğŸ”˜ User 0: Found 4 buttons on page
    Button 0: "speed date", visible: true
    Button 1: "", visible: true
    Button 2: "Respin", visible: true
    Button 3: "Yes", visible: true
  ğŸ“ User 1 current URL: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/voting-window?matchId=98a4c70b-4a5c-4b5a-b94f-c779e612b178
  ğŸ“„ User 1 page content preview: speed dateTTest Male 1, 25Test user - Test Male 19RespinYes(self.__next_f=self.__next_f||[]).push([0])self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7968,[\"9673\",\"static/chunks/9673-e11b620698e...
  ğŸ”˜ User 1: Found 4 buttons on page
    Button 0: "speed date", visible: true
    Button 1: "", visible: true
    Button 2: "Respin", visible: true
    Button 3: "Yes", visible: true
  ğŸ‘† male user clicking "Yes", female user NOT voting (will wait for countdown to expire)...
  ğŸ”˜ male user: Clicking Yes button...
  âœ… male user clicked "Yes" (button text: "âœ“ Yes", disabled: true)
  â³ Waiting for vote window to expire (60 seconds)... User2 (female) will NOT vote.
  â³ Waiting 65 seconds for vote window expiration...
  ğŸ“‹ Browser console messages: [0] ğŸ”˜ Yes button clicked {matchId: 98a4c70b-4a5c-4b5a-b94f-c779e612b178, userVote: null} | [0] ğŸ“¤ Sending vote: {matchId: 98a4c70b-4a5c-4b5a-b94f-c779e612b178, voteType: yes} | [0] ğŸ“¥ Vote response: {status: 200, ok: true, statusText: } | [0] ğŸ“¥ Vote response data: {message: Waiting for partner to vote, outcome: null, completed: false, debug_info: Object} | [0] â³ Waiting for partner to vote {message: Waiting for partner to vote, matchId: 98a4c70b-4a5c-4b5a-b94f-c779e612b178} | [0] ğŸ” Checking match outcome immediately after vote... {matchId: 98a4c70b-4a5c-4b5a-b94f-c779e612b178} | [0] ğŸ” Checking match outcome immediately after vote... {matchId: 98a4c70b-4a5c-4b5a-b94f-c779e612b178} | [0] ğŸ” Checking match outcome immediately after vote... {matchId: 98a4c70b-4a5c-4b5a-b94f-c779e612b178} | [1] â° Countdown reached 0 - vote window expired, checking match status... | [0] â° Countdown reached 0 - vote window expired, checking match status... | [1] â° Countdown expiration - Vote check: {userVoted: false, currentUserId: 634ac8f3-f5a1-4745-a9c7-d129f186e1f6, match_user1_id: 634ac8f3-f5a1-4745-a9c7-d129f186e1f6, match_user2_id: ce7b7d6d-bb49-4a52-9724-7ef006951bbe, match_user1_vote: null} | [1] â° Countdown expiration - User did not vote, redirecting to /spin | [0] â° Countdown expiration - Vote check: {userVoted: yes, currentUserId: ce7b7d6d-bb49-4a52-9724-7ef006951bbe, match_user1_id: 634ac8f3-f5a1-4745-a9c7-d129f186e1f6, match_user2_id: ce7b7d6d-bb49-4a52-9724-7ef006951bbe, match_user1_vote: null} | [0] â° Countdown expiration - User voted, redirecting to /spinning | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe | [0] âš ï¸ Real-time subscription error: user-state-ce7b7d6d-bb49-4a52-9724-7ef006951bbe
  â³ Checking final user states after vote window expiration...
  ğŸ“ Final URLs: User1 (male, voted yes): https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spinning, User2 (female, didn't vote): https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spin
  âœ… Correct redirects after vote window expiration:
     - male user (voted yes) â†’ /spinning (auto-spun) âœ“
     - female user (didn't vote) â†’ /spin or /spinning âœ“

ğŸ“ˆ MATCH ANALYSIS:
Total users created: 2
Successfully signed in: 2
Matched users: 2
Unmatched users: 0
Total matches created: 1
Signed-in females: 1/1
Signed-in males: 1/1
Expected matches: 1 (one per signed-in female, limited by males)

ğŸ” ISSUES FOUND:
âœ… No issues found - all expected matches occurred correctly!

ğŸ“‹ DETAILED BREAKDOWN:
Matched females: 0/1 (0 failed to sign in)
Matched males: 0/1 (0 failed to sign in)
Unmatched females: 1
Unmatched males: 1

ğŸ‘¥ UNMATCHED SIGNED-IN USERS:
  - male Test Male 1 - Current URL: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spinning
  - female Test Female 1 - Current URL: https://speed-l7srpf28o-eds-projects-934496ce.vercel.app/spin

ğŸ§¹ Cleaning up all users...

ğŸ‰ TEST PASSED - All expected matches occurred correctly!
ğŸ§¹ Cleaning up test users...
Â·
  1 passed (2.4m)
