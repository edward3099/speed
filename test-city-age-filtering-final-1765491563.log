
> speed-date@0.1.0 test
> playwright test tests/city-age-filtering.spec.ts

[dotenv@17.2.3] injecting env (6) from .env.local -- tip: ğŸ“¡ add observability to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

Running 1 test using 1 worker
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: âš™ï¸  enable debug logging with { debug: true }
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ” encrypt with Dotenvx: https://dotenvx.com
(node:33804) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
ğŸŒ Testing against Vercel: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app
ğŸ‘¤ Creating test users with different city preferences and ages...
âœ… All test users created
âš™ï¸ Updating user profiles with ages...
âš™ï¸ Setting up user preferences via Supabase...
âœ… Preferences set
ğŸŒ Opening browser contexts and signing in users...
  âœ… Test Male London signed in
  âœ… Test Female London signed in
  âœ… Test Female North signed in
  âœ… Test Female Old signed in
  âœ… Test Female No City signed in
âš™ï¸ Setting preferences via UI...
ğŸ° All users clicking Start Spin simultaneously...
  âœ… Test Female London clicked Start Spin
  âœ… Test Female Old clicked Start Spin
  âœ… Test Female No City clicked Start Spin
  âœ… Test Male London clicked Start Spin
  âœ… Test Female North clicked Start Spin

ğŸ“Š Checking match results...
  Test Male London: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/voting-window?matchId=67cb079c-13a8-43c4-a63b-a196988d3c04
  Test Female London: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning
  Test Female North: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning
  Test Female Old: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/voting-window?matchId=67cb079c-13a8-43c4-a63b-a196988d3c04
  Test Female No City: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning

ğŸ“ˆ MATCH ANALYSIS:
  âœ… Match 67cb079c...:
     - Test Male London (male)
     - Test Female Old (female)
âŒ Test failed: Error: âŒ ISSUE: User 1 matched with Test Female Old but age is out of range!
    at [90m/Users/bb/Desktop/speed/[39mtests/city-age-filtering.spec.ts:314:23
    at [90m/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:322:9
    at [90m/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/testInfo.js:311:11
    at TimeoutManager.withRunnable [90m(/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/timeoutManager.js:67:14[90m)[39m
    at TestInfoImpl._runWithTimeout [90m(/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/testInfo.js:309:7[90m)[39m
    at [90m/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:320:7
    at WorkerMain._runTest [90m(/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:295:5[90m)[39m
    at WorkerMain.runTestGroup [90m(/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:199:11[90m)[39m
    at process.<anonymous> [90m(/Users/bb/Desktop/speed/[39mnode_modules/[4mplaywright[24m/lib/common/process.js:65:22[90m)[39m

ğŸ§¹ Cleaning up test users...
âœ… Cleanup complete
Ã—[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`
(node:34614) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
ğŸŒ Testing against Vercel: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app
ğŸ‘¤ Creating test users with different city preferences and ages...
âœ… All test users created
âš™ï¸ Updating user profiles with ages...
âš™ï¸ Setting up user preferences via Supabase...
âœ… Preferences set
ğŸŒ Opening browser contexts and signing in users...
  âœ… Test Male London signed in
  âœ… Test Female London signed in
  âœ… Test Female North signed in
  âœ… Test Female Old signed in
  âœ… Test Female No City signed in
âš™ï¸ Setting preferences via UI...
ğŸ° All users clicking Start Spin simultaneously...
  âœ… Test Female Old clicked Start Spin
  âœ… Test Female No City clicked Start Spin
  âœ… Test Female London clicked Start Spin
  âœ… Test Male London clicked Start Spin
  âœ… Test Female North clicked Start Spin

ğŸ“Š Checking match results...
  Test Male London: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/voting-window?matchId=1bc70f32-fc09-4328-8a0c-68c54bb3cf83
  Test Female London: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/voting-window?matchId=1bc70f32-fc09-4328-8a0c-68c54bb3cf83
  Test Female North: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning
  Test Female Old: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning
  Test Female No City: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spin

ğŸ“ˆ MATCH ANALYSIS:
  âœ… Match 1bc70f32...:
     - Test Male London (male)
     - Test Female London (female)
     âœ… Valid match: Test Female London has overlapping cities or no city preference

ğŸ“Š TEST RESULTS:
Expected matches for User 1:
  âœ… User 2 (London overlap, age compatible)
  âœ… User 5 (no city preference, age compatible)
  âŒ User 3 (no city overlap)
  âŒ User 4 (age out of range)

ğŸ§¹ Cleaning up test users...
âœ… Cleanup complete
Â±

  1) [chromium] â€º tests/city-age-filtering.spec.ts:19:7 â€º City and Age Filtering Tests â€º should only match users with overlapping cities and compatible age ranges 

    Error: âŒ ISSUE: User 1 matched with Test Female Old but age is out of range!

      312 |               }
      313 |               if (partner.email.includes('old')) {
    > 314 |                 throw new Error(`âŒ ISSUE: User 1 matched with ${partner.name} but age is out of range!`)
          |                       ^
      315 |               }
      316 |               if (partner.email.includes('london') || partner.email.includes('no-city')) {
      317 |                 console.log(`     âœ… Valid match: ${partner.name} has overlapping cities or no city preference`)
        at /Users/bb/Desktop/speed/tests/city-age-filtering.spec.ts:314:23

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/city-age-filtering-City-an-ad29a-s-and-compatible-age-ranges-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/city-age-filtering-City-an-ad29a-s-and-compatible-age-ranges-chromium/test-failed-4.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #3: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/city-age-filtering-City-an-ad29a-s-and-compatible-age-ranges-chromium/test-failed-3.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #4: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/city-age-filtering-City-an-ad29a-s-and-compatible-age-ranges-chromium/test-failed-2.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #5: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/city-age-filtering-City-an-ad29a-s-and-compatible-age-ranges-chromium/test-failed-5.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/city-age-filtering-City-an-ad29a-s-and-compatible-age-ranges-chromium/error-context.md

  1 flaky
    [chromium] â€º tests/city-age-filtering.spec.ts:19:7 â€º City and Age Filtering Tests â€º should only match users with overlapping cities and compatible age ranges 
