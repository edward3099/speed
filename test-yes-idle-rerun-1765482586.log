
> speed-date@0.1.0 test
> playwright test tests/load-test-50males-20females.spec.ts

[dotenv@17.2.3] injecting env (6) from .env.local -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops

Running 1 test using 1 worker
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ” prevent committing .env to code: https://dotenvx.com/precommit
(node:43438) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
ğŸŒ Testing against Vercel: https://speed-silk.vercel.app
ğŸ‘¤ Creating 1 male users via backend...
âœ… All 1 male users created
ğŸ‘¤ Creating 1 female users via backend...
âœ… All 1 female users created
ğŸŒ Opening browser contexts for all users...
âœ… Created 2 browser contexts
ğŸ” Signing in all users (batched to avoid server overload)...
  Signing in batch 1/1 (2 users)...
  âœ… Batch 1 complete: 2/2 users signed in
âœ… Sign-in complete: 2/2 users successfully signed in
ğŸ° 2 users clicking Start Spin (in batches)...
  Batch 1/1: 2 users clicking Start Spin...
  âœ… Batch 1 complete
âœ… 2 users clicked Start Spin
â³ Waiting for matches to occur (45 seconds)...
ğŸ“Š Checking match status for all signed-in users...

ğŸ—³ï¸ Testing voting flow: One user votes "yes", other doesn't vote (vote window expires)...
  Found match 21865887-e095-47cf-ab18-162c53a75350 with 2 users - testing yes_idle scenario (vote window expires)...
  â³ Waiting for both users to reach voting-window...
  ğŸ‘† male user clicking "Yes", female user NOT voting (will wait for countdown to expire)...
  âŒ Failed to click Yes for male user: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

Locator: locator('button').filter({ hasText: /yes/i }).first()
Expected: visible
Timeout: 20000ms
Error: element(s) not found

Call log:
[2m  - Expect "toBeVisible" with timeout 20000ms[22m
[2m  - waiting for locator('button').filter({ hasText: /yes/i }).first()[22m

  â³ Waiting for vote window to expire (60 seconds)... User2 (female) will NOT vote.
  â³ Waiting 65 seconds for vote window expiration...
  ğŸ“‹ Browser console messages: [0] â° Countdown reached 0 - vote window expired, checking match status... | [1] â° Countdown reached 0 - vote window expired, checking match status... | [0] â° Countdown expiration - Vote check: {userVoted: null, currentUserId: d2fc8a26-d0bf-4a32-95ff-20726d5d8ae8, match_user1_id: 61aa00ab-99ac-4314-b13b-658c84c6bf2d, match_user2_id: d2fc8a26-d0bf-4a32-95ff-20726d5d8ae8, match_user1_vote: null} | [0] â° Countdown expiration - User did not vote, redirecting to /spin | [1] â° Countdown expiration - Vote check: {userVoted: false, currentUserId: 61aa00ab-99ac-4314-b13b-658c84c6bf2d, match_user1_id: 61aa00ab-99ac-4314-b13b-658c84c6bf2d, match_user2_id: d2fc8a26-d0bf-4a32-95ff-20726d5d8ae8, match_user1_vote: null} | [1] â° Countdown expiration - User did not vote, redirecting to /spin
  â³ Checking final user states after vote window expiration...
  ğŸ“ Final URLs: User1 (male, voted yes): https://speed-silk.vercel.app/spin, User2 (female, didn't vote): https://speed-silk.vercel.app/spin
  âš ï¸ Unexpected redirects:
     - male user (voted yes): Expected /spinning, got https://speed-silk.vercel.app/spin
     - female user (didn't vote): Expected /spin or /spinning, got https://speed-silk.vercel.app/spin

ğŸ“ˆ MATCH ANALYSIS:
Total users created: 2
Successfully signed in: 2
Matched users: 2
Unmatched users: 0
Total matches created: 1
Signed-in females: 1/1
Signed-in males: 1/1
Expected matches: 1 (one per signed-in female, limited by males)

ğŸ” ISSUES FOUND:
1. ISSUE: Only 0/1 signed-in females matched (1 females and 1 males signed in)
2. ISSUE: 1 females stuck waiting (still on /spin or /spinning) - they should have matched
3. ISSUE: Only 0/2 users reached /video-date after both voting yes (expected both to redirect)

ğŸ“‹ DETAILED BREAKDOWN:
Matched females: 0/1 (0 failed to sign in)
Matched males: 0/1 (0 failed to sign in)
Unmatched females: 1
Unmatched males: 1

ğŸ‘¥ UNMATCHED SIGNED-IN USERS:
  - male Test Male 1 - Current URL: https://speed-silk.vercel.app/spin
  - female Test Female 1 - Current URL: https://speed-silk.vercel.app/spin

ğŸ§¹ Cleaning up all users...

âŒ TEST COMPLETED WITH 3 ISSUE(S) - See above for details
ğŸ§¹ Cleaning up test users...
Â·
  1 passed (3.0m)
