
> speed-date@0.1.0 test
> playwright test tests/city-age-filtering.spec.ts

[dotenv@17.2.3] injecting env (6) from .env.local -- tip: ğŸ“¡ add observability to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops

Running 1 test using 1 worker
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ”„ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ğŸ“¡ add observability to secrets: https://dotenvx.com/ops
(node:40850) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
ğŸŒ Testing against Vercel: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app
ğŸ‘¤ Creating test users with different city preferences and ages...
âœ… All test users created
âš™ï¸ Updating user profiles with ages...
âš™ï¸ Setting up user preferences via Supabase...
âœ… Preferences set. Verification: [
  {
    userId: [32m'd5aa5c01'[39m,
    city: [ [32m'London'[39m, [32m'South England'[39m ],
    cityType: [32m'array'[39m,
    cityLength: [33m2[39m,
    ageRange: [32m'20-30'[39m
  },
  {
    userId: [32m'035f9dee'[39m,
    city: [ [32m'London'[39m, [32m'Midlands'[39m ],
    cityType: [32m'array'[39m,
    cityLength: [33m2[39m,
    ageRange: [32m'20-30'[39m
  },
  {
    userId: [32m'60f3dd53'[39m,
    city: [ [32m'North England'[39m ],
    cityType: [32m'array'[39m,
    cityLength: [33m1[39m,
    ageRange: [32m'25-35'[39m
  },
  {
    userId: [32m'cf75dba0'[39m,
    city: [ [32m'London'[39m ],
    cityType: [32m'array'[39m,
    cityLength: [33m1[39m,
    ageRange: [32m'30-40'[39m
  },
  {
    userId: [32m'722cf504'[39m,
    city: [1mnull[22m,
    cityType: [32m'null'[39m,
    cityLength: [33m0[39m,
    ageRange: [32m'20-30'[39m
  }
]
ğŸŒ Opening browser contexts and signing in users...
  âœ… Test Male London signed in
  âœ… Test Female London signed in
  âœ… Test Female North signed in
  âœ… Test Female Old signed in
  âœ… Test Female No City signed in
âš™ï¸ Setting preferences via UI...
ğŸ° All users clicking Start Spin simultaneously...
  âœ… Test Female London clicked Start Spin
  âœ… Test Female North clicked Start Spin
  âœ… Test Female No City clicked Start Spin
  âœ… Test Male London clicked Start Spin
  âœ… Test Female Old clicked Start Spin

ğŸ“Š Checking match results...
  Test Male London: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/voting-window?matchId=5f274a7b-d223-4995-8615-3a74f24cc044
  Test Female London: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/voting-window?matchId=5f274a7b-d223-4995-8615-3a74f24cc044
  Test Female North: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning
  Test Female Old: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spinning
  Test Female No City: https://speed-1m1nczlh6-eds-projects-934496ce.vercel.app/spin

ğŸ“ˆ MATCH ANALYSIS:
  âœ… Match 5f274a7b...:
     - Test Male London (male)
     - Test Female London (female)
     âœ… Valid match: Test Female London has overlapping cities or no city preference

ğŸ“Š TEST RESULTS:
Expected matches for User 1:
  âœ… User 2 (London overlap, age compatible)
  âœ… User 5 (no city preference, age compatible)
  âŒ User 3 (no city overlap)
  âŒ User 4 (age out of range)

ğŸ§¹ Cleaning up test users...
âœ… Cleanup complete
Â·
  1 passed (1.3m)
